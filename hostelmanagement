import java.util.*;

class Run 
{
    public static void main(String args[]) 
	{
        Scanner sc = new Scanner(System.in);
        Hostel h = new Hostel();
        System.out.println("Welcome to Hostel Management System!");
        System.out.println("Hostel Name: Stanza Hostel");

        while (true) 
		{
            System.out.println("\nHostel Management System");
            System.out.println("1. Add Student");
            System.out.println("2. Display Available Rooms");
            System.out.println("3. Remove Student");
            System.out.println("4. Display All Students");
            System.out.println("5. Display Weekly Food Menu");
			System.out.println("6.Manages Fees(pay and check)");
            System.out.println("7. Exit");
            System.out.print("Choose an option: ");
            int ch = sc.nextInt();

            switch (ch) 
			{
                case 1:
                    h.AddStudent();
                    break;
                case 2:
                    h.DisplayAvailableRooms();
                    break;
                case 3:
                    h.RemoveStudent();
                    break;
                case 4:
                    h.DisplayStudents();
                    break;
                case 5:
                    h.DisplayFoodMenu();
                    break;
				case 6:
				    h.ManagesFees();
                case 7:
                    System.out.println("Exiting...");
                    break;
                default:
                    System.out.println("Invalid choice. Please try again.");
            }
        }
    }
}

class Hostel 
{
    String[] name;
    int[] age;
	int ID=1;
    int[] studentID;
    int[] roomAllocation;
    int[] rooms;
    int[] feesPaid;
    long[] mobile_no;
    final int totalFees;
    int count;

    // Constructor to initialize instance variables
    Hostel() 
	{
        this.name = new String[50];
        this.age = new int[50];
        this.studentID = new int[50];
        this.roomAllocation = new int[50];
        this.rooms = new int[10];
        this.feesPaid = new int[50];
        this.mobile_no = new long[50];
        this.totalFees = 50000;
        this.count = 0;
    }


    // Method to add a student
    void AddStudent() 
	{
        Scanner sc = new Scanner(System.in);

        if (count >= 50) 
		{
            System.out.println("Hostel is full. Cannot add more students.");
            return;
        }

        System.out.print("Enter Name: ");
        name[count] = sc.nextLine();
		boolean u=true;
			while (u) 
			{
			for (int i = 0; i < name[count].length(); i++) 
			{
				char ch = name[count].charAt(i);
				// Check if the character is not a letter (A-Z or a-z)
				if (((ch >= 'A' && ch <= 'Z') || (ch >= 'a' && ch <= 'z'))) 
				{
					 u = false; // Name is valid, exit loop
				}
				else 
			{
				System.out.println("Invalid name. Please enter a name with only letters (A-Z).");
				name[count] = sc.nextLine(); // Prompt the user again
			}
			}
		}
        System.out.print("Enter Age: ");
        age[count] = sc.nextInt();
        sc.nextLine(); // Consume newline
		
        if (age[count] < 15 || age[count] >= 25) 
		{
			System.out.println("You cannot join the Hostel age must be 15 to 25");
			return;
        }
		long number;
		System.out.println("Enter Mobile number");
		number=sc.nextLong();
        String s=number+"";
		boolean b=true;
		while(b)
		{
			s=number+"";
			if(s.length()!=10)
			{
				System.out.println("Enter 10 digit mobile number");
			     number=sc.nextLong();
			}
			else
			{
				b=false;
				mobile_no[count]=number;
			}
		}
		DisplayAvailableRooms();
        System.out.print("Enter Room Number (1-10): ");
        int roomNumber = sc.nextInt();

        if (roomNumber < 1 || roomNumber > 10 || rooms[roomNumber - 1] >= 5) {
            System.out.println("Invalid room number or room is full. Try again.");
            return;
        }

        rooms[roomNumber - 1]++;
        roomAllocation[count] = roomNumber;
        System.out.println("Student " + name[count] + " added to Room " + roomNumber);
		studentID[count]=ID;
		ID++;
        count++;
	}
    // Display available rooms
    void DisplayAvailableRooms() 
	{
        System.out.println("Available Rooms:");
        for (int i = 0; i < rooms.length; i++) 
		{
            if (rooms[i] < 5) 
			{
                System.out.println("Room " + (i + 1) + " has " + (5 - rooms[i]) + " spots available.");
            }
        }
    }

    // Remove student
    void RemoveStudent() 
	{
        Scanner sc = new Scanner(System.in);
        System.out.print("Enter Student ID to Remove: ");
        int Id = sc.nextInt();
        int studentIndex = -1;

        for (int i = 0; i < count; i++) 
		{
            if (studentID[i]==Id) 
			{
                studentIndex = i;
                break;
            }
        }

        if (studentIndex == -1) 
		{
            System.out.println("Student not found.");
            return;
        }

        int roomNumber = roomAllocation[studentIndex] - 1;
        if (roomNumber >= 0) 
		{
            rooms[roomNumber]--;
        }

        for (int i = studentIndex; i < count - 1; i++) 
		{
            name[i] = name[i + 1];
            age[i] = age[i + 1];
            this.studentID[i] = this.studentID[i + 1];
            roomAllocation[i] = roomAllocation[i + 1];
			mobile_no[i]=mobile_no[i+1];
        }		
        count--;

        System.out.println("Student removed successfully.");
    }

    // Display all students
    void DisplayStudents() 
	{
        if (count == 0) 
		{
            System.out.println("No students found.");
            return;
        }

        System.out.println("\nList of All Students:");
        for (int i = 0; i < count; i++) 
		{
            System.out.println("Student ID: " + studentID[i]);
            System.out.println("Name: " + name[i]);
            System.out.println("Age: " + age[i]);
            System.out.println("Room Allocated: Room " + roomAllocation[i]);
			System.out.println("Moblie number="+mobile_no[i]);
            System.out.println("-----------------------------");
        }
    }

    //display weekly food menu
    void DisplayFoodMenu() 
	{
    System.out.println("\nHostel Weekly Food Menu:");
    System.out.println("------------------------------------------------------------");
    System.out.println("Day        | Breakfast  | Lunch      | Dinner");
    System.out.println("-------------------------------------------------------------");
    System.out.println("Monday     | Idli       | Rice & Dal | Roti & Paneer");
    System.out.println("Tuesday    | Poha       | Rajma Rice | Dosa & Chutney");
    System.out.println("Wednesday  | Paratha    | Chole Puri | Fried Rice");
    System.out.println("Thursday   | Upma       | Biryani    | Chapati & Aloo");
    System.out.println("Friday     | Bread      | Sambar     | Dal & Roti");
    System.out.println("Saturday   | Aloo Paratha | Kadhi Rice | Noodles & Soup");
    System.out.println("Sunday     | Chole Bhature | Dal Makhani | Pulao & Raita");
    System.out.println("--------------------------------------------------------------");
}
  //Manage fees
   void ManagesFees()
   {
	   Scanner sc=new Scanner(System.in);
	   System.out.println("\n1.Pay fees");
	   System.out.println("2.check Fee status");
	   System.out.println("Choose an option:");
	   int choice=sc.nextInt();
	   sc.nextLine();
	   if(choice==1)
	   {
		   System.out.println("Enter Student ID to pay fees:");
		   int id=sc.nextInt();
		   for(int i=0;i<count;i++)
		   {
			   if(studentID[i]==id)
			   {
				   System.out.println("\nTotal Fees: "+totalFees);
				   System.out.println("Paid fees:"+feesPaid[i]);
				   System.out.println("Remaining fees:"+(totalFees-feesPaid[i]));
				   boolean e=true;
				   while(e)
				   {
				   System.out.println("Enter amount to pay:");
				   int amount=sc.nextInt();
				   if(amount<0 || (feesPaid[i]+amount)>totalFees)
				   {
					   System.out.println("Invalid amount Please Enter valid fee amount"); 
					   e=true;
				   }
				   else
				   {
					   feesPaid[i]+=amount;
					   System.out.println("Fees paid sucessfully.Remaining Fees"+(totalFees-feesPaid[i]));
					   e=false;
				   }
			   }
			   }
			   else
			   {
		   System.out.println("Student ID not found");
		       }
		}
	   }
		else if(choice==2)
		{
			if(count==0)
			{
				System.out.println("No student found");
				return;
			}
			System.out.println("\nFees payment status");
			System.out.println("-----------------------------------------------------------------------------------------");
			System.out.println(" studentID  |  name |   Paid |  Remaining");
			System.out.println("-------------------------------------------------------------------------------------------");
			for(int i=0;i<count;i++)
			{
				System.out.println(studentID[i]+   "  |  "  +name[i]+  "  |  " +feesPaid[i]+ "  |  "  +(totalFees-feesPaid[i]));
			}
			System.out.println("--------------------------------------------------------------------------------------------");
		}
		else
		{
			System.out.println("Invalid choice.");
		}
    }
}
